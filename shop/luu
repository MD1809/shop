tên trang chínhchính



<?php session_start(); ?>
<?php require_once('config.php') ?>

<?php
 $total = 0;
 if (isset($_SESSION['cart']) && count($_SESSION['cart']) > 0){
     foreach ($_SESSION['cart'] as $index => $item){
         $subtotal = $item['price'] * $item['quantity'];
         $total += $subtotal;
     }
 }else{
     $check_cart = " trống!";
 } 

?>
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Đặt Hàng</title>
    <link rel="stylesheet" href="assets/css/base.css">
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="container-Order">
        <form action="place_order.php" method="post" class="container-order">
            <div class="shipping-info">
                <h2>THÔNG TIN GIAO HÀNG</h2>
                <div class="input-group">
                    <input type="text" name="fullname" placeholder="Nhập vào Họ Tên">
                    <input type="text" name="phone" placeholder="Nhập vào Số điện thoại">
                </div>
                <input id="email" type="email" name="email" placeholder="Nhập vào Email">
                <div class="input-group">
                    <select name="province">
                        <option value="aa">Chọn Tỉnh...</option>
                        <option value="HCM">Hồ Chí Minh</option>
                        <!-- Thêm các tỉnh khác -->
                    </select>

                    <select name="district">
                        <option value="aaaa">Chọn Quận...</option>
                    </select>

                    <select name="ward">
                        <option value="aaaa">Chọn Phường...</option>
                    </select>

                </div>
                <input id="addressdetail" name="address_detail" type="text" placeholder="Địa chỉ chi tiết (Số nhà, ấp...)">
                <textarea name="note" placeholder="Ghi chú"></textarea>
            </div>
    
            <div class="order-summary">
                <h2>ĐƠN HÀNG</h2>
                <div class="order-items">
                    <?php
                     if(empty($_SESSION['cart'])){
                         echo $check_cart;
                     } else 
                     foreach ($_SESSION['cart'] as &$item): 
                    ?>
                    <div class="order-item">
                        <img src="assets/images/<?php echo $item['image']; ?>" alt="anh">
                        <div class="item-details">
                            <p><?php echo $item['name']; ?></p>
                            <div class="quantity-control">
                                <button class="sl decrease-qty" type="button">-</button>
                                <input type="number" name="quantity[]" class="item-qty" value="<?php echo $item['quantity'] ?>" min="1">
                                <button class="sl increase-qty" type="button">+</button>
                            </div>
                        </div>
                        <div class="item-price" data-price="<?php echo $item['price']; ?>">
                            <?php echo number_format($item['price']); ?>đ
                        </div>
                        <button class="remove-item">x</button>
                    </div>
                <?php endforeach; ?>
                </div>
                <div class="order-totals">
                    <p>Giảm giá <span>-0₫</span></p>
                    <p>Phí giao hàng <span>Miễn phí</span></p>
                    <p class="total-amount">Tổng tiền 
                        <span id="total-price">
                            <?php echo !empty($_SESSION['cart']) ? number_format($total) : '0'; ?>đ
                        </span>  
                    </p>
                </div>
                <button class="add-more-products">Chọn thêm sản phẩm khác</button>
            </div>
    
            <div class="payment-method">
                <h2>PHƯƠNG THỨC THANH TOÁN</h2>
                <div class="radio-option">
                    <input type="radio" id="cod" name="payment" value="COD" checked>
                    <label>Thanh toán khi nhận hàng (COD)</label>
                </div>
            </div>
            <input type="hidden" name="total_price" value="<?php  echo $total; ?>">
            
            <button class="order_button" name="order_button">THANH TOÁN ĐƠN HÀNG</button> 
        </div>
    </div>

    <script>
        // Hàm định dạng tiền tệ
        function formatCurrency(number) {
            return number.toLocaleString('vi-VN') + 'đ';
        }
        // Hàm tính tổng tiền tất cả sản phẩm
        function updateTotalPrice() {
            let totalprice = 0;
            document.querySelectorAll('.order-item').forEach(function (item) {
                const qty = parseInt(item.querySelector('.item-qty').value);
                const price = parseInt(item.querySelector('.item-price').dataset.price);
                totalprice += qty * price;
            });

            document.getElementById('total-price').textContent = formatCurrency(totalprice);
        }
        // Lặp qua tất cả các sản phẩm
        document.querySelectorAll('.order-item').forEach(function (item) {
            const decreaseBtn = item.querySelector('.decrease-qty');
            const increaseBtn = item.querySelector('.increase-qty');
            const qtyInput = item.querySelector('.item-qty');
            const priceInput = item.querySelector('.item-price');
            const unitPrice = parseInt(priceInput.dataset.price);

            function updatePrice() {
                let qty = parseInt(qtyInput.value);
                if (isNaN(qty) || qty < 1) qty = 1;
                priceInput.textContent = formatCurrency(qty * unitPrice);
                updateTotalPrice();
            }

            decreaseBtn.addEventListener('click', function (e) {
                e.preventDefault();
                let qty = parseInt(qtyInput.value);
                if (qty > 1) {
                    qtyInput.value = qty - 1;
                    updatePrice();
                }
            });

            increaseBtn.addEventListener('click', function (e) {
                e.preventDefault();
                qtyInput.value = parseInt(qtyInput.value) + 1;
                updatePrice();
            });

            qtyInput.addEventListener('input', updatePrice);
        });

    </script>

</body>
</html>




<!-- indexindex -->
 <section class="product">
                <!-- Sản phẩm laptop -->
                <h2 class="product__title">laptop</h2>
                <div class="product__list">
    
                    <?php
                        // thực hiện truy vấn lấy dữ liệu laptop
                        $sql_laptop = "SELECT p.id_product, p.name, p.price, p.image
                                        FROM products p
                                        JOIN categories c ON p.category_id = c.id_categorie
                                        WHERE c.name = 'Laptop'
                                        limit 10";
                        $result_laptops = $conn->query($sql_laptop);

                        // nếu có dữ liệu
                        if ($result_laptops->num_rows > 0) {
                            while($product = $result_laptops->fetch_assoc()) {
                                // gán biến
                                $id = $product['id_product'];
                                $image = $product['image'];
                                $name = $product['name'];
                                $price = $product['price'];
                                // Bắt đầu in ra HTML
                                echo '<article class="product-card">
                                    <a href="detailProduct.php?id='.$id.'" class="product-card_link">
                                        <img src="assets/image/' . htmlspecialchars($image) . '" alt="' . htmlspecialchars($image) . '" class="product-card__image">
                                        <div class="product-card__describe">
                                            <h4 class="product-card__name">' . htmlspecialchars($name) . '</h4>
                                            <p class="product-card__price">' . number_format($price) . 'đ</p>
                                        </div>
                                        <div class="product-card__review">
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                        </div>
                                    </a>
                                </article>';
                            }
                        }
                    ?>
                </div>
                <!-- Sản phẩm phụ kiện -->
                <h2 class="product__title margin_title">phụ kiện</h2>
                <div class="product__list">
                    <?php
                        // thực hiện truy vấn lấy dữ liệu laptop
                        $sql_pkien = "SELECT p.id_product, p.name, p.price, p.image
                                        FROM products p
                                        JOIN categories c ON p.category_id = c.id_categorie
                                        WHERE c.name = 'Phụ Kiện'
                                        limit 10";
                        $result_pkien = $conn->query($sql_pkien);

                        // nếu có dữ liệu
                        if ($result_pkien->num_rows > 0) {
                            while($product = $result_pkien->fetch_assoc()) {
                                // gán biến
                                $id = $product['id_product'];
                                $image = $product['image'];
                                $name = $product['name'];
                                $price = $product['price'];
                                // Bắt đầu in ra HTML
                                echo'
                                <article class="product-card">
                                    <a href="detailProduct.php?id='.$id.'" class="product-card_link">
                                        <img src="assets/image/' . htmlspecialchars($image) . '" alt="' . htmlspecialchars($image) . '" class="product-card__image">
                                        <div class="product-card__describe">
                                            <h4 class="product-card__name">' . htmlspecialchars($name) . '</h4>
                                            <p class="product-card__price">' . number_format($price) . 'đ</p>
                                        </div>
                                        <div class="product-card__review">
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                            <i class="fa-solid fa-star"></i>
                                        </div>
                                    </a>
                                </article>';
                            }
                        }
                    ?>
                </div>
            </section>